<!doctype html>
<html>
<!-- COMP-301 - Assignment 4 - 300864022 - Gordon Stevens -->

<head>
  <style>
    body {
      background: red;
      background: -ms-linear-gradient(top, red, yellow) fixed;
      background: -o-linear-gradient(top, red, yellow) fixed;
      background: -moz-linear-gradient(top, red, yellow) fixed;
      background: -webkit-linear-gradient(top, red, yellow) fixed;
      background: linear-gradient(top, red, yellow) fixed;
      background-repeat: no-repeat;
      background-attachment: fixed;
      height: 100%;
      width: 48%;
      margin: 15pt auto;
      text-align: center;
    }
    fieldset {
      border-radius: 17pt;
      text-align: center;
      margin-bottom: 15pt;
    }
    legend {
      font-size 22pt;
      font-weight: bold;
    }
    label {
      vertical-align: middle;
      font-size: 22pt;
      font-weight: bold;
      display: inline-block;
      width: 205px;
      text-align: right;
    }
    input[type='radio'], input[type='checkbox'], input[type='text'], select {
      border: 3pt solid rgb(192,192,192);
      border-radius: 3pt;
      background: rgb(224,224,224);
      background-image: -moz-linear-gradient(rgb(240,240,240),rgb(224,224,224));
      background-image: -ms-linear-gradient(rgb(240,240,240),rgb(224,224,224));
      background-image: -o-linear-gradient(rgb(240,240,240),rgb(224,224,224));
      background-image: -webkit-linear-gradient(rgb(240,240,240),rgb(224,224,224));
      background-image: linear-gradient(rgb(240,240,240),rgb(224,224,224));
      vertical-align: middle;
      font-size: 22pt;
    }
    .formButton {
      font-size: 22pt;
    }
    .clearDiv {
      clear: both;
      margin-bottom: 7pt;
    }
    .errorMsgText {
      font-size: 24pt;
    }
    .shipLabelPackage {
      font-size: 16pt;
      font-weight: 700;
    }
    .shipLabelFrom {
      font-size: 18pt;
      font-weight: 600;
    }
    .shipLabelTo {
      font-size: 24pt;
      font-weight: 900;
    }
  </style>
  <title>COMP-301 - Assignment 4 - 300864022 - Gordon Stevens</title>
</head>

<body>
<?php
# =============================================================================
#  Function: displayMainForm       -  Display the main data entry form
#  Function: displayShippingLabel  -  Display the shipping label
# =============================================================================
function displayMainForm()
{
  echo "  <form action=\"";
  echo $_SERVER['PHP_SELF'];
  echo "\" method=\"post\">\n";
  echo "    <fieldset>\n";
  echo "      <legend>Package Information</legend>\n";
  echo "      <label for=\"pkgWeight\">Weight (Kg):</label>\n";
  echo "      <input id=\"pkgWeight\" name=\"pkgWeight\" type=\"text\" maxlength=\"2\" placeholder=\"Weight (Kg)\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"pkgLength\">Length (cm):</label>\n";
  echo "      <input id=\"pkgLength\" name=\"pkgLength\" type=\"text\" maxlength=\"3\" placeholder=\"Length (cm)\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"pkgWidth\">Width (cm):</label>\n";
  echo "      <input id=\"pkgWidth\" name=\"pkgWidth\" type=\"text\" maxlength=\"3\" placeholder=\"Width (cm)\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"pkgHeight\">Height (cm):</label>\n";
  echo "      <input id=\"pkgHeight\" name=\"pkgHeight\" type=\"text\" maxlength=\"3\" placeholder=\"Height (cm)\">\n";
  echo "    </fieldset>\n";
  echo "    <fieldset>\n";
  echo "      <legend>Your Shipping Address</legend>\n";
  echo "      <label for=\"fromName\">Name:</label>\n";
  echo "      <input id=\"fromName\" name=\"fromName\" type=\"text\" maxlength=\"75\" placeholder=\"Your Name\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"fromAddressLine1\">Address Line 1:</label>\n";
  echo "      <input id=\"fromAddressLine1\" name=\"fromAddressLine1\" type=\"text\" maxlength=\"50\" placeholder=\"Address Line 1\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"fromAddressLine2\">Address Line 2:</label>\n";
  echo "      <input id=\"fromAddressLine2\" name=\"fromAddressLine2\" type=\"text\" maxlength=\"50\" placeholder=\"Address Line 2\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"fromProvince\">Province:</label>\n";
  echo "      <select name=\"fromProvince\" id=\"fromProvince\">\n";
  echo "        <option>Select a Province</option>\n";
  echo "        <option value=\"AB\">Alberta</option>\n";
  echo "        <option value=\"BC\">British Columbia</option>\n";
  echo "        <option value=\"MB\">Manitoba</option>\n";
  echo "        <option value=\"NB\">New Brunswick</option>\n";
  echo "        <option value=\"NL\">Newfoundland and Labrador</option>\n";
  echo "        <option value=\"NS\">Nova Scotia</option>\n";
  echo "        <option value=\"NT\">Northwest Territories</option>\n";
  echo "        <option value=\"NU\">Nunavut</option>\n";
  echo "        <option value=\"ON\">Ontario</option>\n";
  echo "        <option value=\"PE\">Prince Edward Island</option>\n";
  echo "        <option value=\"QC\">Quebec</option>\n";
  echo "        <option value=\"SK\">Saskatchewan</option>\n";
  echo "        <option value=\"YT\">Yukon</option>\n";
  echo "      </select>\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label id=\"fromPostalCode\">Postal Code:</label>\n";
  echo "      <input id=\"fromPostalCode\" name=\"fromPostalCode\" type=\"text\" maxlength=\"7\" placeholder=\"Postal Code (L#L #L#)\">\n";
  echo "    </fieldset>\n";
  echo "    <fieldset>\n";
  echo "      <legend>Destination Shipping Address</legend>\n";
  echo "      <label for=\"toName\">Name:</label>\n";
  echo "      <input id=\"toName\" name=\"toName\" type=\"text\" maxlength=\"75\" placeholder=\"Name or Department\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"toAddressLine1\">Address Line 1:</label>\n";
  echo "      <input id=\"toAddressLine1\" name=\"toAddressLine1\" type=\"text\" maxlength=\"50\" placeholder=\"Address Line 1\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"toAddressLine2\">Address Line 2:</label>\n";
  echo "      <input id=\"toAddressLine2\" name=\"toAddressLine2\" type=\"text\" maxlength=\"50\" placeholder=\"Address Line 2\">\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label for=\"toProvince\">Province:</label>\n";
  echo "      <select name=\"toProvince\" id=\"toProvince\">\n";
  echo "        <option>Select a Province</option>\n";
  echo "        <option value=\"AB\">Alberta</option>\n";
  echo "        <option value=\"BC\">British Columbia</option>\n";
  echo "        <option value=\"MB\">Manitoba</option>\n";
  echo "        <option value=\"NB\">New Brunswick</option>\n";
  echo "        <option value=\"NL\">Newfoundland and Labrador</option>\n";
  echo "        <option value=\"NS\">Nova Scotia</option>\n";
  echo "        <option value=\"NT\">Northwest Territories</option>\n";
  echo "        <option value=\"NU\">Nunavut</option>\n";
  echo "        <option value=\"ON\">Ontario</option>\n";
  echo "        <option value=\"PE\">Prince Edward Island</option>\n";
  echo "        <option value=\"QC\">Quebec</option>\n";
  echo "        <option value=\"SK\">Saskatchewan</option>\n";
  echo "        <option value=\"YT\">Yukon</option>\n";
  echo "      </select>\n";
  echo "      <div class=\"clearDiv\"></div>\n";
  echo "      <label id=\"toPostalCode\">Postal Code:</label>\n";
  echo "      <input id=\"toPostalCode\" name=\"toPostalCode\" type=\"text\" maxlength=\"7\" placeholder=\"Postal Code (L#L #L#)\">\n";
  echo "    </fieldset>\n";
  echo "    <fieldset>\n";
  echo "      <input type=\"submit\" class=\"formButton\" value=\"Register Shipping\">\n";
  echo "      <input type=\"reset\" class=\"formButton\" value=\"Clear Form\">\n";
  echo "    </fieldset>\n";
  echo "  </form>\n";
}
function displayShippingLabel($pkgWeight, $pkgLength, $pkgWidth, $pkgHeight, $fromName, $fromAddressLine1, $fromAddressLine2, $fromProvince, $fromPostalCode, $toName, $toAddressLine1, $toAddressLine2, $toProvince, $toPostalCode)
{
  echo "  <fieldset>\n";
  echo "    <legend>Shipping Label</legend>\n";
  echo "    <h2>Package Information:</h2>\n";
  echo "    <div class=\"shipLabelPackage\">Weight: $pkgWeight Kg<br>Length: $pkgLength cm<br>Width: $pkgWidth cm<br>Height: $pkgHeight cm</div>\n\t\t<br><br>\n";
  echo "    <h2>From:</h2>\n";
  if ($fromAddressLine2)
    echo "    <div class=\"shipLabelFrom\">Name: $fromName<br>Address: $fromAddressLine1<br>$fromAddressLine2<br>Province: $fromProvince<br>Postal Code: $fromPostalCode</div>\n\t\t<br><br>\n";
  else
    echo "    <div class=\"shipLabelFrom\">Name: $fromName<br>Address: $fromAddressLine1<br>Province: $fromProvince<br>Postal Code: $fromPostalCode</div>\n<br><br>\n";
  echo "    <h2>To:</h2>\n";
  if ($toAddressLine2)
    echo "    <div class=\"shipLabelTo\">Name: $toName<br>Address: $toAddressLine1<br>$toAddressLine2<br>Province: $toProvince<br>Postal Code: $toPostalCode</div>\n";
  else
    echo "    <div class=\"shipLabelTo\">Name: $toName<br>Address: $toAddressLine1<br>Province: $toProvince<br>Postal Code: $toPostalCode</div>\n";
  echo "  </fieldset>\n";
}
# =============================================================================
#  Function: valName         -  Check name
#  Function: valWeight       -  Check weight validity
#  Function: valDimension    -  Check length range
#  Function: valAddressLine  -  Check number of characters in address line
#  Function: valProvince     -  Check valid Canadian province
#  Function: valPostalCode   -  Check a Canadian postal code
# =============================================================================
function valName($name)
{
  return ((strlen($name) >= 5) && (strlen($name) <= 75)) ? true : false; // Validity: Between 5 and 75 Characters
}
function valWeight($pkgw)
{
  return (($pkgw <= 50) && ($pkgw > 0)) ? true : false; // Validity Range: >0 - 50Kg? Return TRUE
}
function valDimension($pkgDimension)
{
  return (($pkgDimension <= 150) && ($pkgDimension > 0)) ? true : false; // Validity Range: >0 - 150cm? Return TRUE
}
function valAddressLine($pkgal)
{
  return ((strlen($pkgal) <= 50) && (strlen($pkgal) > 0)) ? true : false; // Validity Range 1 - 50 Characters? Return TRUE
}
function valProvince($provchk)
{
  $provinceAbbr = array("AB", "BC", "MB", "NB", "NL", "NS", "NT", "NU", "ON", "PE", "QC", "SK", "YT");
  return ((strlen($provchk) == 2) && (in_array($provchk, $provinceAbbr, true))) ? true : false; // Validity: 2 Characters AND abbreviated province code? Return TRUE
}
function valPostalCode($pcode)
{
  $pcodemask6 = "/^[a-ceghj-npr-tv-z]{1}[0-9]{1}[a-ceghj-npr-tv-z]{1}[0-9]{1}[a-ceghj-npr-tv-z]{1}[0-9]{1}$/i"; // Valid Postal Code WITHOUT a SPACE CHARACTER and Letters a-ceghj-npr-tv-z
  $pcodemask7 = "/^[a-ceghj-npr-tv-z]{1}[0-9]{1}[a-ceghj-npr-tv-z]{1}\ {1}[0-9]{1}[a-ceghj-npr-tv-z]{1}[0-9]{1}$/i"; // Valid Postal Code WITH a SPACE CHARACTER and Letters a-ceghj-npr-tv-z
  return ((preg_match($pcodemask6,$pcode)) || (preg_match($pcodemask7,$pcode))) ? true : false; // Use a 6 or 7 character RegEx mask
}
# =============================================================================
#  Function: valFormMain  -  Validate various values
#  Function: valStart     -  Validate that all variables are set
# =============================================================================
function valFormMain()
{
  $pkgWeight = ($_POST['pkgWeight']);
  if (valweight($pkgWeight) == false)
    echo "\t<div class=\"errorMsgText\">Invalid <strong>weight value</strong>.<br>Weight must be between 0Kg and 50Kg.</div>\n<br>\n";

  $pkgLength = ($_POST['pkgLength']);
  if (!valDimension($pkgLength))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>length value</strong>.<br>Length must be between 0cm and 150cm.</div>\n<br>\n";

  $pkgWidth = ($_POST['pkgWidth']);
  if (!valDimension($pkgWidth))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>width value</strong>.<br>Width must be between 0cm and 150cm.</div>\n<br>\n";

  $pkgHeight = ($_POST['pkgHeight']);
  if (!valDimension($pkgHeight))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>height value</strong>.<br>Height must be between 0cm and 150cm.</div>\n<br>\n";

  $fromName = ($_POST['fromName']);
  if (!valName($fromName))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>Sender Name</strong>.<br>Name must be between 5 and 75 characters.</div>\n<br>\n";

  $fromAddressLine1 = ($_POST['fromAddressLine1']);
  if (!valAddressLine($fromAddressLine1))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>address value</strong>.<br>Address must be between 1 and 50 characters.</div>\n<br>\n";

  $fromProvince = ($_POST['fromProvince']);
  if (valProvince($fromProvince) == false)
    echo "\t<div class=\"errorMsgText\">Invalid <strong>Canadian Province</strong>.</div>\n<br>\n";

  $fromPostalCode = strtoupper($_POST['fromPostalCode']);
  if (!valPostalCode($fromPostalCode))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>Canadian postal code</strong>.</div>\n<br>\n";

  $toName = ($_POST['toName']);
  if (!valName($toName))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>Receipient Name</strong>.<br>Name must be between 5 and 75 characters.</div>\n<br>\n";

  $toAddressLine1 = ($_POST['toAddressLine1']);
  if (!valAddressLine($toAddressLine1))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>destination address value</strong>.<br>Address must be between 1 and 50 characters.</div>\n<br>\n";

  $toProvince = ($_POST['toProvince']);
  if (valProvince($toProvince) == false)
    echo "\t<div class=\"errorMsgText\">Invalid <strong>Canadian destination province</strong>.<div>\n<br>\n";

  $toPostalCode = strtoupper($_POST['toPostalCode']);
  if (!valPostalCode($toPostalCode))
    echo "\t<div class=\"errorMsgText\">Invalid <strong>Canadian destination postal code</strong>.</div>\n<br>\n";

  $toAddressLine2 = ($_POST['toAddressLine2']);
  $fromAddressLine2 = ($_POST['fromAddressLine2']);

  if ((valWeight($pkgWeight)) && (valDimension($pkgLength)) && (valDimension($pkgWidth)) && (valDimension($pkgHeight)) && (valName($fromName)) && (valAddressLine($fromAddressLine1)) && (valProvince($fromProvince)) && (valPostalCode($fromPostalCode)) && (valName($toName)) && (valAddressLine($toAddressLine1)) && (valProvince($toProvince)) && (valPostalCode($toPostalCode)))
  // IF validated: Weight, length, width, height, address lines 1, provinces, postal codes?   Print shipping label!
    displayShippingLabel($pkgWeight, $pkgLength, $pkgWidth, $pkgHeight, $fromName, $fromAddressLine1, $fromAddressLine2, $fromProvince, $fromPostalCode, $toName, $toAddressLine1, $toAddressLine2, $toProvince, $toPostalCode);
}
function formStart()
{
  // IF NOT all POST variables are SET displayMainForm
  if (!(isset($_POST['pkgWeight'])) && !(isset($_POST['pkgLength'])) && !(isset($_POST['pkgWidth'])) && !(isset($_POST['pkgHeight'])) && !(isset($_POST['fromName'])) && !(isset($_POST['fromAddressLine1'])) && !(isset($_POST['fromProvince'])) && !(isset($_POST['fromPostalCode'])) && !(isset($_POST['toName'])) && !(isset($_POST['toAddressLine1'])) && !(isset($_POST['toProvince'])) && !(isset($_POST['toPostalCode'])))
    displayMainForm();
  else
    valFormMain(); // All vars set
}
# ================================================================================
#  Call the main program  -  COMP-301 - Assignment 4 - 300864022 - Gordon Stevens
# ================================================================================
formStart();
?>
</body>

</html>
